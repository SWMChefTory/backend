[[VoiceCommand-API]]
= VoiceCommand API

== 음성 명령 로그 저장 (POST /papi/v1/voice-command)

=== 1.1 성공 – 음성 명령 기록 저장

==== 요청
include::{snippets}/voice-command-history-controller/given-valid-voice-command-request/when-creating-voice-command/then-should-create-voice-command-history/http-request.adoc[]

==== 요청 본문
include::{snippets}/voice-command-history-controller/given-valid-voice-command-request/when-creating-voice-command/then-should-create-voice-command-history/request-body.adoc[]

==== 요청 필드
include::{snippets}/voice-command-history-controller/given-valid-voice-command-request/when-creating-voice-command/then-should-create-voice-command-history/request-fields.adoc[]

==== 응답
include::{snippets}/voice-command-history-controller/given-valid-voice-command-request/when-creating-voice-command/then-should-create-voice-command-history/http-response.adoc[]

==== 응답 본문
include::{snippets}/voice-command-history-controller/given-valid-voice-command-request/when-creating-voice-command/then-should-create-voice-command-history/response-body.adoc[]

==== 응답 필드
include::{snippets}/voice-command-history-controller/given-valid-voice-command-request/when-creating-voice-command/then-should-create-voice-command-history/response-fields.adoc[]

=== 1.2 에러 – 존재하지 않는 유저

==== 요청
include::{snippets}/voice-command-history-controller/given-invalid-request/when-request-with-non-existent-user-id/then-should-return-bad-request/http-request.adoc[]

==== 응답
include::{snippets}/voice-command-history-controller/given-invalid-request/when-request-with-non-existent-user-id/then-should-return-bad-request/http-response.adoc[]

==== 응답 본문
include::{snippets}/voice-command-history-controller/given-invalid-request/when-request-with-non-existent-user-id/then-should-return-bad-request/response-body.adoc[]

==== 에러 필드
include::{snippets}/voice-command-history-controller/given-invalid-request/when-request-with-non-existent-user-id/then-should-return-bad-request/response-fields.adoc[]

=== 1.3 에러 – 필수 필드 누락

==== 요청
include::{snippets}/voice-command-history-controller/given-invalid-request/when-request-with-missing-required-fields/then-should-return-bad-request/http-request.adoc[]

==== 응답
include::{snippets}/voice-command-history-controller/given-invalid-request/when-request-with-missing-required-fields/then-should-return-bad-request/http-response.adoc[]

==== 응답 본문
include::{snippets}/voice-command-history-controller/given-invalid-request/when-request-with-missing-required-fields/then-should-return-bad-request/response-body.adoc[]

==== 에러 필드
include::{snippets}/voice-command-history-controller/given-invalid-request/when-request-with-missing-required-fields/then-should-return-bad-request/response-fields.adoc[]

=== 1.4 에러 – 지원하지 않는 STT 모델

==== 요청
include::{snippets}/voice-command-history-controller/given-invalid-request/when-request-with-unsupported-stt-model/then-should-return-bad-request/http-request.adoc[]

==== 응답
include::{snippets}/voice-command-history-controller/given-invalid-request/when-request-with-unsupported-stt-model/then-should-return-bad-request/http-response.adoc[]

==== 응답 본문
include::{snippets}/voice-command-history-controller/given-invalid-request/when-request-with-unsupported-stt-model/then-should-return-bad-request/response-body.adoc[]

==== 에러 필드
include::{snippets}/voice-command-history-controller/given-invalid-request/when-request-with-unsupported-stt-model/then-should-return-bad-request/response-fields.adoc[]

=== 1.5 에러 – 지원하지 않는 Intent 모델

==== 요청
include::{snippets}/voice-command-history-controller/given-invalid-request/when-request-with-unsupported-intent-model/then-should-return-bad-request/http-request.adoc[]

==== 응답
include::{snippets}/voice-command-history-controller/given-invalid-request/when-request-with-unsupported-intent-model/then-should-return-bad-request/http-response.adoc[]

==== 응답 본문
include::{snippets}/voice-command-history-controller/given-invalid-request/when-request-with-unsupported-intent-model/then-should-return-bad-request/response-body.adoc[]

==== 에러 필드
include::{snippets}/voice-command-history-controller/given-invalid-request/when-request-with-unsupported-intent-model/then-should-return-bad-request/response-fields.adoc[]

== 에러 코드 정리

[cols="1,1,2,1"]
|===
|HTTP 상태|에러 코드|설명|해결 방법

|400
|USER_NOT_FOUND
|존재하지 않는 유저 ID
|유효한 유저 ID로 재시도

|400
|FIELD_REQUIRED
|필수 필드 누락
|누락된 필드 추가 후 재시도

|400
|VOICE_COMMAND_UNKNOWN_STT_MODEL
|지원하지 않는 STT 모델
|VITO 모델 사용

|400
|VOICE_COMMAND_UNKNOWN_INTENT_MODEL
|지원하지 않는 Intent 모델
|GPT4.1 또는 REGEX 모델 사용
|===